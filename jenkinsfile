
  pipeline {
  agent any 
  environment {     
    DOCKERHUB_CREDENTIALS= credentials('DOCKERHUB_CREDENTIALS_GIZ')     
} 
 stages{
  stage('checkout'){
    steps{
	checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[credentialsId: 'GitHUB_Credentials-Giz', url: 'https://github.com/ggutu/simplePython-microservices-.git']])
	}
    }
	stage('docker build image'){
    steps{
	 script{
	  sh  'docker build -t gizachewgutu/microservice:late .'
	  sh 'apt install sudo' 
	   }
	}
    }
   stage('Login to Docker Hub') {      	
    steps{                       	
	sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'             		
	echo 'Login Completed'      
    }           
} 
stage('Push Image to Docker Hub') {         
    steps{  
		script{                       
 sh 'docker push gizachewgutu/microservice:latest'           
 echo 'Push Image Completed'      
		} 
    }            
} 
     stage('Logout of Docker Hub (Optional)') {
            steps {
                script {
                    sh 'docker logout' // Uncomment if you want to log out after pushing
                    echo 'Docker Logout Completed (Optional)'
                }
            }
        }
 }
 }